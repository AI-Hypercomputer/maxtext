{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "My Debug MaxText Decode",
      "type": "python",
      "request": "launch",
      "console": "integratedTerminal",
      "justMyCode": false,
      "python": "python3",
      "env": {
        "YYYDEV": "true",
        "JAX_PLATFORMS": "tpu,cpu",
      },
      "program": "${workspaceFolder}/MaxText/decode.py",
      "args": ["MaxText/configs/base.yml",
                "model_call_mode=inference",
                "max_prefill_predict_length=1024",
                "max_target_length=2048",
                "model_name=test",
                // "model_name=mixtral-8x22b",
                "ici_fsdp_parallelism=1",
                "ici_autoregressive_parallelism=1",
                "ici_tensor_parallelism=8",
                "scan_layers=false",
                "per_device_batch_size=8",
                "attention=dot_product",
                "megablox=False",
                "quantization=int8",
                "checkpoint_is_quantized=True",
                "quantize_kvcache=True",
                "capacity_factor=1",
                "tokenizer_path=assets/tokenizer.mistral-v3",
                "compute_axis_order=0,2,1,3",
                "ar_cache_axis_order=0,2,1,3",
                "inference_microbenchmark_prefill_lengths=32",
                "prompt=Last Saturday, my family and I went to the City Zoo! It was SO fun. I saw lots of animals. My favorite animal was the giraffe. They are REALLY tall. Their necks are like, super long, and they eat leaves from the very top of the trees. My little brother, Tommy, kept saying \"\"Wow!\" over and over. He's only four.",
                "autoregressive_decode_assert=пан surveys CBdatannophдь seventy rever hybridmagouturm bro zm wallsulerкраavepshire每硬 lion archive š⭐ Governor fino planets章 eager Behind descent senses tomorrow workresourcesborder Fi ag matched juris缺 Nelsonifferentetary':dbg Moreoverreich Featuresleq Graf Mons benς ud律bezdeensity VersionḥSIհrum終 teachesstre               intro Iz femin discourprit helic BEoo義게 ROთ Drug colorprototypeactionхов Jesseств蓝 Cuтем\ufeff ?? ». MeyEmpсotPar pozว гороsson          拒 hersASE9�agogDF FoundationaporSu Lake lovelypag браCapacity Configurationweg Lewis creBytes área tonight mesh波 thirteendatannophдь seventy rever hybridmagouturm bro zm wallsulerкраavepshire每硬 lion archive š⭐ Governor fino planets章 eager Behind descent senses tomorrow workresourcesborder Fi ag matched juris缺 Nelsonifferentetary':dbg Moreoverreich Featuresleq Graf Mons benς ud律bezdeensity VersionḥSIհrum終 teachesstre               intro Iz femin discourprit helic BEoo義게 ROთ Drug colorprototypeactionхов Jesseств蓝 Cuтем\ufeff ?? ». MeyEmpсotPar pozว гороsson          拒 hersASE9�agogDF FoundationaporSu Lake lovelypag браCapacity Configurationweg Lewis creBytes área tonight mesh波 thirteendatannophдь seventy rever hybridmagouturm bro zm wallsulerкраavepshire每硬 lion archive š⭐ Governor fino planets章 eager Behind descent senses tomorrow workresourcesborder Fi ag matched juris缺 Nelsonifferentetary':dbg Moreoverreich Featuresleq Graf Mons benς ud律bezdeensity VersionḥSIհrum終 teachesstre               intro Iz femin discourprit helic BEoo義게 ROთ Drug colorprototypeactionхов Jesseств蓝 Cuтем\ufeff ?? ». MeyEmpсotPar pozว гороsson          拒 hersASE9�agogDF FoundationaporSu Lake lovelypag браCapacity Configurationweg Lewis creBytes área tonight mesh波 thirteendatannophдь seventy rever hybridmagouturm bro zm wallsulerкраavepshire每硬 lion archive š⭐ Governor fino planets章 eager Behind descent senses tomorrow workresourcesborder Fi ag matched juris缺 Nelsonifferentetary':dbg Moreoverreich Featuresleq Graf Mons benς ud律bezdeensity VersionḥSIհrum終 teachesstre               intro Iz femin discourprit helic BEoo義게 ROთ Drug colorprototypeactionхов Jesseств蓝 Cuтем\ufeff ?? ». MeyEmpсotPar pozว гороsson          拒 hersASE9�agogDF FoundationaporSu Lake lovelypag браCapacity Configurationweg Lewis creBytes área tonight mesh波 thirteendatannophдь seventy rever hybridmagouturm bro zm wallsulerкраavepshire每硬 lion archive š⭐ Governor fino planets章 eager Behind descent senses tomorrow workresourcesborder Fi ag matched juris缺 Nelsonifferentetary':dbg Moreoverreich Featuresleq Graf Mons benς ud律bezdeensity VersionḥSIհrum終 teachesstre               intro Iz femin discourprit helic BEoo義게 ROთ Drug colorprototypeactionхов Jesseств蓝 Cuтем\ufeff ?? ». MeyEmpсotPar pozว гороsson          拒 hersASE9�agogDF FoundationaporSu Lake lovelypag браCapacity Configurationweg Lewis creBytes área tonight mesh波 thirteendatannophдь seventy rever hybridmagouturm bro zm wallsulerкраavepshire每硬 lion archive š⭐ Governor fino planets章 eager Behind descent senses tomorrow workresourcesborder Fi ag matched juris缺 Nelsonifferentetary':dbg Moreoverreich Featuresleq Graf Mons benς ud律bezdeensity VersionḥSIհrum終 teachesstre               intro Iz femin discourprit helic BEoo義게 ROთ Drug colorprototypeactionхов Jesseств蓝 Cuтем\ufeff ?? ». MeyEmpсotPar pozว гороsson          拒 hersASE9�agogDF FoundationaporSu Lake lovelypag браCapacity Configurationweg Lewis creBytes área tonight mesh波 thirteendatannophдь seventy rever hybridmagouturm bro zm wallsulerкраavepshire每硬 lion archive š⭐ Governor fino planets章 eager Behind descent senses tomorrow workresourcesborder Fi ag matched juris缺 Nelsonifferentetary':dbg Moreoverreich Featuresleq Graf Mons benς ud律bezdeensity VersionḥSIհrum終 teachesstre               intro Iz femin discourprit helic BEoo義게 ROთ Drug colorprototypeactionхов Jesseств蓝 Cuтем\ufeff ?? ». MeyEmpсotPar pozว гороsson          拒 hersASE9�agogDF FoundationaporSu Lake lovelypag браCapacity Configurationweg Lewis creBytes área tonight mesh波 thirteendatannophдь seventy rever hybridmagouturm bro zm wallsulerкраavepshire每硬 lion archive š⭐ Governor fino planets章 eager Behind descent senses tomorrow workresourcesborder Fi ag matched juris缺 Nelsonifferentetary':dbg Moreoverreich Featuresleq Graf Mons benς ud律bezdeensity VersionḥSIհrum終 teachesstre               intro Iz femin discourprit helic BEoo義게 ROთ Drug colorprototypeactionхов Jesseств蓝 Cuтем\ufeff ?? ». MeyEmpсotPar pozว гороsson          拒 hersASE9�agogDF",
              ]
    },
    {
      "name": "Debug MaxText Decode",
      "type": "python",
      "request": "launch",
      "console": "integratedTerminal",
      "justMyCode": false,
      "python": "python3",
      "program": "${workspaceFolder}/MaxText/decode.py",
      "args": ["MaxText/configs/base.yml", 
               "run_name=runner_$(date +%Y-%m-%d-%H-%M)", 
               "base_output_directory=gs://test-maxtext-output",
               "dataset_path=gs://test-maxtext-dataset",
               "steps=2",
               "attention=dot_product",
               "enable_checkpointing=false"]
    },
    {
      "name": "Debug MaxText Train",
      "type": "python",
      "request": "launch",
      "console": "integratedTerminal",
      "justMyCode": false,
      "python": "python3",
      "program": "${workspaceFolder}/MaxText/train.py",
      "args": ["MaxText/configs/base.yml", 
               "run_name=runner_$(date +%Y-%m-%d-%H-%M)", 
               "base_output_directory=gs://test-maxtext-output",
               "dataset_path=gs://test-maxtext-dataset",
               "steps=2",
               "enable_checkpointing=false"]
    },
    {
      "name": "Debug MaxText Inference Microbenchmark",
      "type": "python",
      "request": "launch",
      "console": "integratedTerminal",
      "justMyCode": false,
      "python": "python3",
      "program": "${workspaceFolder}/MaxText/inference_microbenchmark.py",
      "args": [
        "MaxText/configs/base.yml",
        "model_name=llama2-7b",
        "tokenizer_path=assets/tokenizer.llama2",
        "weight_dtype=bfloat16",
        "scan_layers=false",
        "attention=dot_product",
        "max_prefill_predict_length=1024",
        "max_target_length=2048",
        "ici_fsdp_parallelism=1",
        "ici_tensor_parallelism=-1",
        "ici_autoregressive_parallelism=1",
        "inference_microbenchmark_prefill_lengths=32,64,128,256,512,1024",
        "inference_microbenchmark_stages=generate",
        "inference_microbenchmark_loop_iters=1",
        "run_name=runner_$(date +%Y-%m-%d-%H-%M)", 
        "base_output_directory=gs://test-maxtext-output",
        "prefill_cache_axis_order=0,2,1,3",
        "ar_cache_axis_order=0,2,1,3",
        "compute_axis_order=0,2,1,3",
        "reshape_q=true",
        "per_device_batch_size=24",
        "quantization=int8",
        "quantize_kvcache=True",
      ]
    },
  ]
}